# GapGaussLegendre DOS Fixed

Finally, I fixed the weird none flat Gapped DOS. 

![GapGL_DOS](fig/17-May-2024/GapGL_DOS.svg)

It was something like 

![Wrong_DOS](/Users/u5575142/Desktop/Louhokseson.github.io/Typora/fig/17-May-2024/Wrong_DOS.svg)

The bathcoupling factors comes from the Gauss-Legendre quadratures' weights $\alpha_i$ which are fixed values when have a certain number of the knots $x_i \in [-1,1]$. 

In the gapped model, we have two bands. i.e. Valence band and Conduction band. The weights can be linearly transformated into a more general representation $\tilde{\alpha}_i$.
$$
\tilde{\alpha}_i = \frac{\text{length of band}}{2} \cdot \alpha_i
$$

- Length of band: length of the valence band or conduction band.
- $\dfrac{\cdot}{2}$ : $x_i$ are sampled from $[-1,1]$​​ already with length 2. Dividing by 2 is normalisation from the Legendre polynomial's roots.

New implementation in NQCModels.jl of GapGaussLegendre

```julia
knots, weights = gausslegendre(div(M, 2))
ΔE = bandmax - bandmin
bandlengths = (ΔE - gapwidth)/2
.
.
.
# coupling is the sqrt() of the weights times the bandlengths/2 [valence band's coupling ; conduction band's coupling]
bathcoupling = [sqrt.(weights.*bandlengths/2); sqrt.(weights.*bandlengths/2)]

```

Just make the code a bit more concise and simple. The details of plotting the correct DOS can be viewed at [here](https://github.com/maurergroup/NQCModels.jl/blob/hokseson/plots/GapDOS.jl).



# Density of State in NA

